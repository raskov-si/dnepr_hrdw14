/*!
    \file порт coldfire
*/

#include <assert.h>
#include <stddef.h>
#include "reserv/core/inc/rsrv_typedef.h"
#include "rsrv_os.h"

/*=============================================================================================================*/

/*=============================================================================================================*/
/*!  \brief 

     \sa 
*/
/*=============================================================================================================*/
int rsrv_os_lock_create(TrsrvOsSem  *sem)
{
    sem = OSSemCreate(1);
    if (sem != NULL) {
        return RSRV_OK;
    }

    return RSRV_OS_ERR;
}


/*=============================================================================================================*/
/*!  \brief 

     \sa 
*/
/*=============================================================================================================*/
int rsrv_os_lock(TrsrvOsSem  *sem)
{
    int8_t  code;

    assert(sem != NULL);

    OSSemPend(sem, 0, &code);
    if ( code == OS_ERR_NONE) {
        return RSRV_OK;
    }

    return RSRV_OS_ERR;
}

/*=============================================================================================================*/
/*!  \brief 

     \sa 
*/
/*=============================================================================================================*/
int rsrv_os_unlock(TrsrvOsSem  *sem)
{
    assert(sem != NULL);

    int8_t  code = OSSemPost(sem);

    if ( code == OS_ERR_NONE) {
        return RSRV_OK;
    }

    return RSRV_OS_ERR;
}

/*=============================================================================================================*/

